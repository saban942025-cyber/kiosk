<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sika Studio - × ×™×”×•×œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Heebo', sans-serif; background: #111; color: white; padding: 40px; }
        .card { background: #222; border: 1px solid #333; padding: 25px; border-radius: 20px; margin-bottom: 20px; }
        .input-dark { background: #000; border: 1px solid #444; color: white; padding: 12px; border-radius: 10px; width: 100%; display: block; margin-top: 5px; }
        .label { font-size: 12px; color: #888; font-weight: bold; text-transform: uppercase; margin-top: 15px; display: block; }
        .img-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px; }
        .img-item { height: 80px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; opacity: 0.6; }
        .img-item:hover, .img-item.selected { opacity: 1; border-color: #FFC500; }
        .img-item img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body class="max-w-4xl mx-auto">

    <div class="flex justify-between items-center mb-10">
        <h1 class="text-4xl font-black text-[#FFC500]">Sika Studio ğŸ›ï¸</h1>
        <a href="../index.html" target="_blank" class="bg-white text-black px-6 py-2 rounded-full font-bold hover:bg-gray-200">×¤×ª×— ×§×™×•×¡×§ >></a>
    </div>

    <div class="card border-blue-900/50">
        <h2 class="text-xl font-bold mb-4 text-blue-400 flex items-center gap-2"><i data-lucide="key"></i> ×”×’×“×¨×•×ª ×—×™×‘×•×¨ (API)</h2>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="label">Google Search API Key</label>
                <input id="keyGoogle" type="password" class="input-dark" placeholder="AIzaSy...">
            </div>
            <div>
                <label class="label">Search Engine ID (CX)</label>
                <input id="keyCx" type="text" class="input-dark" placeholder="012345...">
            </div>
        </div>
        <button onclick="saveKeys()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg font-bold text-sm">×©××•×¨ ××¤×ª×—×•×ª</button>
    </div>

    <div class="card border-yellow-600/50">
        <h2 class="text-xl font-bold mb-6 text-[#FFC500] flex items-center gap-2"><i data-lucide="package-plus"></i> ×”×•×¡×¤×ª ××•×¦×¨ ×—×“×©</h2>
        
        <div class="flex gap-8">
            <div class="w-1/3">
                <label class="label">×ª××•× ×ª ××•×¦×¨</label>
                <div class="relative group">
                    <img id="previewImg" src="https://placehold.co/400?text=No+Image" class="w-full h-48 object-contain bg-white rounded-xl mb-2 border border-gray-600">
                </div>
                <input id="finalImgUrl" type="hidden">
            </div>

            <div class="w-2/3">
                <label class="label">×©× ×”××•×¦×¨</label>
                <div class="flex gap-2">
                    <input id="pName" class="input-dark" placeholder="×œ××©×œ: Sika Ceram 255">
                    <button onclick="searchImages()" class="bg-gray-700 text-white px-4 rounded-lg mt-1 whitespace-nowrap"><i data-lucide="search"></i> ×—×¤×© ×ª××•× ×”</button>
                </div>

                <div id="googleResults" class="hidden mt-2 p-2 bg-gray-900 rounded-xl">
                    <div class="text-xs text-green-400 mb-1">×ª×•×¦××•×ª ××’×•×’×œ (×œ×—×¥ ×œ×‘×—×™×¨×”):</div>
                    <div class="img-grid" id="imgGrid"></div>
                </div>

                <div class="grid grid-cols-2 gap-4 mt-2">
                    <div>
                        <label class="label">××•×ª×’</label>
                        <select id="pBrand" class="input-dark">
                            <option>SIKA</option>
                            <option>THERMOKIR</option>
                            <option>MISTER FIX</option>
                        </select>
                    </div>
                    <div>
                        <label class="label">×§×˜×’×•×¨×™×”</label>
                        <select id="pCat" class="input-dark">
                            <option value="sealing">××™×˜×•×</option>
                            <option value="glues">×“×‘×§×™×</option>
                            <option value="flooring">×¨×™×¦×•×£</option>
                        </select>
                    </div>
                </div>

                <label class="label">×ª×™××•×¨ ×©×™×•×•×§×™</label>
                <textarea id="pDesc" class="input-dark h-24"></textarea>

                <button onclick="saveProduct()" class="w-full bg-[#E3000F] text-white py-4 rounded-xl font-bold text-lg mt-6 hover:bg-red-600 transition shadow-lg">
                    ×”×•×¡×£ ×œ×§×˜×œ×•×’
                </button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // Load Keys
        window.onload = () => {
            document.getElementById('keyGoogle').value = localStorage.getItem('saban_google_key') || '';
            document.getElementById('keyCx').value = localStorage.getItem('saban_google_cx') || '';
        }

        function saveKeys() {
            localStorage.setItem('saban_google_key', document.getElementById('keyGoogle').value);
            localStorage.setItem('saban_google_cx', document.getElementById('keyCx').value);
            alert("×”××¤×ª×—×•×ª × ×©××¨×•! ×›×¢×ª × ×™×ª×Ÿ ×œ×—×¤×© ×ª××•× ×•×ª.");
        }

        // Google Image Search Logic
        async function searchImages() {
            const query = document.getElementById('pName').value;
            const apiKey = document.getElementById('keyGoogle').value;
            const cx = document.getElementById('keyCx').value;

            if(!query) return alert("×”×–×Ÿ ×©× ××•×¦×¨");
            if(!apiKey || !cx) return alert("×—×¡×¨×™× ××¤×ª×—×•×ª API! ×”×–×Ÿ ××•×ª× ×œ××¢×œ×”.");

            const btn = event.currentTarget;
            btn.innerHTML = "...";
            
            try {
                const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&cx=${cx}&key=${apiKey}&searchType=image&num=4`;
                const res = await fetch(url);
                const data = await res.json();

                const grid = document.getElementById('imgGrid');
                grid.innerHTML = "";
                
                if(data.items) {
                    data.items.forEach(item => {
                        grid.innerHTML += `<div class="img-item" onclick="selectImg('${item.link}', this)"><img src="${item.link}"></div>`;
                    });
                    document.getElementById('googleResults').classList.remove('hidden');
                } else {
                    alert("×œ× × ××¦××• ×ª××•× ×•×ª");
                }
            } catch(e) {
                console.error(e);
                alert("×©×’×™××” ×‘×—×™×¤×•×©");
            }
            btn.innerHTML = `<i data-lucide="search"></i> ×—×¤×© ×ª××•× ×”`;
            lucide.createIcons();
        }

        function selectImg(url, el) {
            document.querySelectorAll('.img-item').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
            document.getElementById('previewImg').src = url;
            document.getElementById('finalImgUrl').value = url;
        }

        // Save Product Logic
        function saveProduct() {
            const product = {
                id: Date.now(),
                name: document.getElementById('pName').value,
                brand: document.getElementById('pBrand').value,
                category: document.getElementById('pCat').value,
                marketingDesc: document.getElementById('pDesc').value,
                image: document.getElementById('finalImgUrl').value || document.getElementById('previewImg').src
            };

            // Save to LocalStorage (Shared with Kiosk)
            let products = JSON.parse(localStorage.getItem('saban_products')) || [];
            products.unshift(product); // Add to top
            localStorage.setItem('saban_products', JSON.stringify(products));

            alert("×”××•×¦×¨ × ×•×¡×£ ×‘×”×¦×œ×—×”! ×¤×ª×— ××ª ×”×§×™×•×¡×§ ×œ×¨××•×ª.");
            location.reload();
        }
    </script>
</body>
</html>
