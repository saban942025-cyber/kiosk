<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Sika Key Diagnostic Tool ğŸ› ï¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>body { font-family: sans-serif; background: #0f172a; color: white; padding: 20px; }</style>
</head>
<body class="max-w-4xl mx-auto">
    
    <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl border border-gray-700">
        <h1 class="text-3xl font-black text-yellow-500 mb-6 flex items-center gap-2">
            <i data-lucide="activity"></i> ×‘×“×™×§×ª ××¤×ª×—×•×ª ××§×™×¤×”
        </h1>

        <div class="mb-6 bg-blue-900/30 p-4 rounded-lg border border-blue-500/30 text-sm text-blue-200">
            ×”×›×œ×™ ×™×‘×“×•×§ ×›×œ ××¤×ª×— ××•×œ ××¡×¤×¨ ××•×“×œ×™× ×•×’×¨×¡××•×ª API ×›×“×™ ×œ××¦×•× ××ª ×”×©×™×œ×•×‘ ×”×× ×¦×—.
        </div>

        <div id="keysContainer" class="space-y-4"></div>

        <button onclick="startScan()" class="mt-8 w-full bg-blue-600 hover:bg-blue-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg transition flex justify-center items-center gap-2">
            <i data-lucide="play"></i> ×”×ª×—×œ ×¡×¨×™×§×”
        </button>
    </div>

    <script>
        lucide.createIcons();
        const KEYS_TO_TEST = [
            "AIzaSyDn2bU0mnmNpj26UeBZYAirLnXf-FtPgCg"
        ];
        // ×”××¤×ª×— ×©×‘×™×§×©×ª ×œ×‘×“×•×§ (××¤×©×¨ ×œ×”×•×¡×™×£ ×¢×•×“ ×œ×¨×©×™××”)


        // ×¨×©×™××ª ×”×¦×™×¨×•×¤×™× ×”××¤×©×¨×™×™× ×œ×‘×“×™×§×” (××•×“×œ + ×’×¨×¡×ª API)
        const ENDPOINTS = [
            { label: "Gemini 1.5 Flash (v1beta)", url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent" },
            { label: "Gemini 1.5 Pro (v1beta)",   url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent" },
            { label: "Gemini 1.0 Pro (v1beta)",   url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.0-pro:generateContent" },
            { label: "Gemini Pro (v1beta)",       url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent" },
            { label: "Gemini Pro (v1)",           url: "https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent" }
        ];

        async function startScan() {
            const container = document.getElementById('keysContainer');
            container.innerHTML = ''; // × ×™×§×•×™ ×ª×•×¦××•×ª ×§×•×“××•×ª

            for (const key of KEYS_TO_TEST) {
                // ×™×¦×™×¨×ª ××–×•×¨ ×œ××¤×ª×—
                const keyBox = document.createElement('div');
                keyBox.className = "bg-gray-900 p-4 rounded-xl border border-gray-700";
                keyBox.innerHTML = `
                    <div class="font-mono text-yellow-400 font-bold mb-3 border-b border-gray-700 pb-2">${key}</div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2" id="results-${key.substring(0,10)}">
                        <div class="text-gray-500 text-sm">×‘×•×“×§... <i data-lucide="loader-2" class="animate-spin inline"></i></div>
                    </div>
                `;
                container.appendChild(keyBox);
                lucide.createIcons();

                const resultsDiv = document.getElementById(`results-${key.substring(0,10)}`);
                resultsDiv.innerHTML = ''; // × ×™×§×•×™ ×”×•×“×¢×ª ×˜×¢×™× ×”

                // ×”×¨×¦×ª ×”×‘×“×™×§×•×ª
                for (const endpoint of ENDPOINTS) {
                    const status = await checkEndpoint(key, endpoint.url);
                    
                    const badge = document.createElement('div');
                    const colorClass = status.ok ? "bg-green-900/40 border-green-600 text-green-400" : "bg-red-900/20 border-red-900/30 text-red-400 opacity-60";
                    const icon = status.ok ? "check-circle" : "x-circle";
                    
                    badge.className = `flex items-center justify-between p-2 rounded border text-xs ${colorClass}`;
                    badge.innerHTML = `
                        <span class="flex items-center gap-2"><i data-lucide="${icon}" size="14"></i> ${endpoint.label}</span>
                        <span>${status.ok ? 'âœ… ×ª×§×™×Ÿ' : status.code}</span>
                    `;
                    resultsDiv.appendChild(badge);
                }
                lucide.createIcons();
            }
        }

        async function checkEndpoint(key, baseUrl) {
            const url = `${baseUrl}?key=${key}`;
            try {
                const response = await fetch(url, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        contents: [{ parts: [{ text: "Hello" }] }] 
                    })
                });

                if (response.ok) return { ok: true, code: 200 };
                return { ok: false, code: response.status }; // ××—×–×™×¨ 404, 403, 429 ×•×›×•'
            } catch (e) {
                return { ok: false, code: "ERR" };
            }
        }
    </script>
</body>
</html>
